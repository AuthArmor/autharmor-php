<HTML>
<HEAD>
	<TITLE>Auth Armor PHP Demo</TITLE>
	<script src="https://cdn.autharmor.com/scripts/autharmor-sdk.js"></script>
</HEAD>
<style>
body {
	margin: 0;
	font-family: "Montserrat",-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing: grayscale;
	color: #fff;
	background-color: #212329;
}
h3 {
	padding: 20px;
	margin-bottom: 80px;
	background-color: #282c34;
	border-radius: 6px;
}
a {
	color: #39dada;
	opacity: .7;
}
input {
	margin: 4px;
}
input[type=text] {
	padding: 12px 20px;
	font-size: 16px;
	border-radius: 4px;
	border: 0;
	background-color: #2d323c;
	min-width: 300px;
	color: hsla(0,0%,100%,.7);
	font-family: "Montserrat";
}
input[type=button] {
	padding: 10px;
	background-color: #2db4b4;
	color: #fff;
	border-radius: 4px;
	border: 0;
}
.content {
	max-width: 500px;
	margin: auto;
	text-align: center;
	color: 
}
</style>
<BODY>
<script>

// Initialize the SDK
const SDK = new AuthArmorSDK("https://myapidomain/");

const register = async (username) => {
	// Generate a new invite
	const invite = await SDK.invite.generateInviteCode({
		nickname: username, // Specify the invite's nickname
		referenceId: "myreference" // Specify a reference ID for the invite
	});
	console.log("Getting invite QR code and link.");
	document.getElementById("auth_profile_id").value = invite.auth_profile_id;
	document.getElementById("qrcode").src = invite.getQRCode();
	document.getElementById("login_success").style.display = "none";
	document.getElementById("confirm_success").style.display = "none";
	document.getElementById("qrcode_and_link").style.display = "inline";
	document.getElementById("invite_link").href = invite.getInviteLink();
};

const confirm = async (username) => {
	// Confirm an invite
	console.log("Confirming invite ID:", username);
	await SDK.invite.confirmInvite(username);
	console.log("Invite has been confirmed successfully!");
	document.getElementById("login_success").style.display = "none";
	document.getElementById("qrcode_and_link").style.display = "none";
	document.getElementById("confirm_success").style.display = "inline";
};

const authenticate = async (username) => {
	// Perform an authentication
	try {
		console.log("Authenticating user:", username);
		await SDK.auth.authenticate(username);
		console.log("User authenticated!");
		document.getElementById("qrcode_and_link").style.display = "none";
		document.getElementById("confirm_success").style.display = "none";
		document.getElementById("login_success").style.display = "inline";
	} catch (err) {
		console.error("The request was declined or has timed out!", err);
	}
};

</script>
<div class="content">
<h3>AuthArmor PHP Demo</h3>
<input id="username" type="text" value="Username" onfocus="this.value='';" /><br />
<input id="login" type="button" value="Login" onclick="authenticate(document.getElementById('username').value);" /> <input id="register" type="button" value="Register" onclick="register(document.getElementById('username').value);" /><br />
<br />
<br />

<div id="login_success" style="display: none;">
You were logged in successfully!
</div>

<div id="qrcode_and_link" style="display: none;">
<input id="auth_profile_id" type="hidden" value="" />
<img id="qrcode" src="" /><br />
<br />
Use the AuthArmor mobile app to scan this QR Code<br />
-or-<br />
<a id="invite_link" target="_blank" href="">Click here</a><br />
<br />
Once enrolled, press the Confirm Invite button<br />
<br />
<input id="confirm_invite" type="button" value="Confirm Invite" onclick="confirm(document.getElementById('username').value);" />
</div>

<div id="confirm_success" style="display: none;">
Your invite has been confirmed!
</div>

</div>
</BODY>
</HTML>

